# เอกสารโค้ด: user-crud.js

## 1. ชื่อไฟล์
**user-crud.js**

## 2. ภาพรวม
ไฟล์นี้เป็นส่วนหนึ่งของระบบจัดการผู้ใช้งาน (User Management) โดยใช้ IndexedDB ที่ชื่อว่า "UserDB"  
มีฟังก์ชันหลักในการสร้าง (Create), ค้นหา (Search), อัปเดต (Update) และลบ (Delete) ข้อมูลผู้ใช้ รวมถึงการแสดงข้อมูลผู้ใช้ในรูปแบบตาราง

## 3. รายละเอียดฟังก์ชันและการทำงาน

- **openDB()**  
  ฟังก์ชันสำหรับเปิดหรือสร้างฐานข้อมูล "UserDB" พร้อมกับสร้าง object store "users"  
  ในกรณีที่เป็นการอัปเกรด จะมีการสร้าง index สำหรับ username ด้วย

- **clearInputs()**  
  ฟังก์ชันสำหรับล้างข้อมูลใน input fields เมื่อดำเนินการต่าง ๆ เสร็จสิ้น

- **displayUsers()**  
  ดึงข้อมูลผู้ใช้ทั้งหมดจากฐานข้อมูลและแสดงในรูปแบบตารางภายใน element ที่มี ID "userList"

- **createUser()**  
  รับข้อมูลจากฟอร์ม (username, password, role) และเพิ่มข้อมูลผู้ใช้ใหม่ลงในฐานข้อมูล  
  มีการแจ้งเตือนเมื่อการสร้างผู้ใช้สำเร็จหรือเกิดข้อผิดพลาด

- **searchUsers()**  
  ฟังก์ชันสำหรับค้นหาผู้ใช้ตามเงื่อนไขที่ระบุ (เช่น userID, username, password, role)  
  แสดงผลลัพธ์ในรูปแบบตารางและแจ้งเตือนว่าพบหรือไม่พบผู้ใช้

- **updateUser()**  
  ฟังก์ชันสำหรับอัปเดตข้อมูลผู้ใช้ โดยค้นหาผู้ใช้ตาม userID แล้วทำการแก้ไขข้อมูลตาม input ที่ระบุ

- **deleteUser()**  
  ลบข้อมูลผู้ใช้จากฐานข้อมูลตาม userID ที่ระบุ  
  นอกจากนี้ หากผู้ใช้ที่ถูกลบเป็นผู้ใช้ที่ล็อกอินอยู่ใน session จะมีการลบ session และเปลี่ยนเส้นทางไปยังหน้า index

## 4. วิธีการใช้งาน
- เมื่อหน้าเว็บโหลดแล้วจะเปิดฐานข้อมูลและแสดงข้อมูลผู้ใช้โดยอัตโนมัติ
- ฟังก์ชันต่าง ๆ ถูกผูกกับปุ่มในฟอร์มเพื่อรองรับการสร้าง ค้นหา อัปเดต และลบผู้ใช้
- ผู้ดูแลระบบหรือผู้ใช้งานสามารถทำการแก้ไขข้อมูลผู้ใช้ได้ผ่านฟอร์มที่จัดเตรียมไว้

## 5. ข้อสังเกต
- ควรตรวจสอบความถูกต้องของข้อมูลจากฟอร์มก่อนดำเนินการใด ๆ  
- การใช้ sessionStorage ในการจัดการ session ของผู้ใช้งานมีความสำคัญสำหรับความปลอดภัย
- ระบบใช้ IndexedDB ในการเก็บข้อมูลผู้ใช้ ทำให้สามารถทำงานในฝั่ง client ได้อย่างอิสระ
