# เอกสารโค้ด: register.js

## 1. ชื่อไฟล์
**register.js**

## 2. ภาพรวม
ไฟล์นี้จัดการหน้าลงทะเบียน (Register) สำหรับผู้ใช้ใหม่  
ระบบจะตรวจสอบข้อมูลที่กรอกในฟอร์มว่าถูกต้องหรือไม่ (เช่น ตรวจสอบว่ารหัสผ่านและยืนยันรหัสผ่านตรงกัน)  
จากนั้นจะเปิดฐานข้อมูล UserDB ผ่าน IndexedDB เพื่อตรวจสอบว่าชื่อผู้ใช้งาน (username) ซ้ำหรือไม่ หากไม่ซ้ำจะทำการสร้างผู้ใช้ใหม่และบันทึกข้อมูลลงในฐานข้อมูล

## 3. รายละเอียดฟังก์ชันและการทำงาน
- **เปิดฐานข้อมูล (openDB):**  
  - ฟังก์ชันนี้เปิดฐานข้อมูล "UserDB" โดยสร้าง object store "users" หากยังไม่มี พร้อมสร้าง index สำหรับ `username` เพื่อความ unique

- **ตรวจสอบโหมดการใช้งานฟอร์ม:**  
  - ตรวจสอบว่าฟอร์มอยู่ในโหมดลงทะเบียนโดยดูจากการแสดงผลของฟิลด์ยืนยันรหัสผ่าน (`password-confirm-group`)

- **ตรวจสอบความถูกต้องของข้อมูล:**  
  - ตรวจสอบว่ารหัสผ่านกับการยืนยันรหัสผ่านตรงกันหรือไม่
  - ตรวจสอบว่าชื่อผู้ใช้งานมีอยู่ในฐานข้อมูลหรือไม่ (โดยใช้ index `username`)

- **สร้างผู้ใช้ใหม่:**  
  - หากไม่มีผู้ใช้งานซ้ำ จะกำหนด role โดยอิงจากชื่อผู้ใช้งาน (ถ้า username เริ่มต้นด้วย "admin-" จะกำหนดเป็น "admin" ไม่เช่นนั้นจะเป็น "user")
  - บันทึกข้อมูลผู้ใช้ใหม่ลงในฐานข้อมูล
  - บันทึกข้อมูลผู้ใช้ใน sessionStorage และเปลี่ยนเส้นทางไปยังหน้าที่เหมาะสมตาม role

## 4. วิธีการใช้งาน
- ผู้ใช้กรอกข้อมูลในฟอร์มลงทะเบียน (Username, Password, Confirm Password)  
- เมื่อส่งฟอร์ม ระบบจะตรวจสอบข้อมูลและดำเนินการลงทะเบียน  
- หากสำเร็จ ผู้ใช้จะถูกเปลี่ยนเส้นทางไปยังหน้าที่เหมาะสม (หน้าผู้ดูแลหรือหน้าการจอง)

## 5. ข้อสังเกต
- ควรตรวจสอบข้อมูลจากฟอร์มให้ครบถ้วนและถูกต้องก่อนดำเนินการลงทะเบียน  
- การใช้ IndexedDB ช่วยให้การจัดการข้อมูลผู้ใช้ในฝั่ง client เป็นไปอย่างมีประสิทธิภาพ  
- ควรมีการจัดการ error ให้เหมาะสมในกรณีที่เกิดข้อผิดพลาดในกระบวนการลงทะเบียน
